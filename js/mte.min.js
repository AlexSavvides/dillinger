/*!
 * ----------------------------------------------------------
 *  MARKDOWN TEXT EDITOR PLUGIN 1.2.1
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * Licensed under the MIT license.
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://fortawesome.github.io/Font-Awesome/icons
 * ==========================================================
 * ----------------------------------------------------------
 *
 */

var MTE=function(e,t){function n(e){return void 0!==e}function l(e){return"number"==typeof e}function r(e){return"function"==typeof e}function i(e){return"object"==typeof e}function a(e,t,n){t="on"+t,r(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),e[t]=n}function o(e,t){e=e||{};for(var n in t)e[n]=i(t[n])?o(e[n],t[n]):t[n];return e}function c(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),l=0;return l=V.defaultView&&V.defaultView.getComputedStyle?V.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function s(e,t){return rt(e,function(){ot(t.end+1,st)}),!1}function u(e){return e.replace(/^\s+|\s+$/g,"")}function f(e){return e.replace(/^\s+/,"")}function p(e){return e.replace(/\s+$/,"")}function d(e){return e.replace(G.escape,"\\$1")}function g(e){return e.parentNode}"prompt"in t&&(t.prompts=t.prompt),"placeholder"in t&&(t.placeholders=t.placeholder),"iconClassPrefix"in t&&(t.toolbarIconClass=t.iconClassPrefix+"%s"),"buttonClassPrefix"in t&&(t.toolbarButtonClass=t.buttonClassPrefix+"%s");var h="\u2018",m="\u2019",v="\u201C",x="\u201D",b="\u2013",C="\u2014",k="\u2026",E="\u00A6",T="\u00A9",y="\u2117",L="\u2120",_="\u2122",O="\u00AE",$="\u00B1",R="\u00D7",H="\u00F7",M="\u00B0",S="\u2039",I="\u203A",w="\u00AB",N="\u00BB",B="\u2264",U="\u2265",P="\u2260",z="\u2190",A="\u2192",K="\u2191",D="\u2193",q="\u21B5",Y=this,F=window,V=document,G=new Editor(e),W={tabSize:"    ",toolbar:!0,shortcut:!1,toolbarClass:"editor-toolbar",toolbarIconClass:"fa fa-%s",toolbarButtonClass:"editor-toolbar-button editor-toolbar-button-%s",toolbarSeparatorClass:"editor-toolbar-separator",toolbarPosition:"before",dropClass:"custom-drop custom-%s-drop",modalClass:"custom-modal custom-modal-%s",modalHeaderClass:"custom-modal-header custom-modal-%s-header",modalContentClass:"custom-modal-content custom-modal-%s-content",modalFooterClass:"custom-modal-action custom-modal-%s-action",modalOverlayClass:"custom-modal-overlay custom-modal-%s-overlay",STRONG:"**",EM:"_",UL:"- ",OL:"%d. ",HR:"---",CODE:"`",PRE:"    ",buttons:{ok:"OK",yes:"Yes",no:"No",cancel:"Cancel",open:"Open",close:"Close",bold:"Bold",italic:"Italic",code:"Code",quote:"Quote",heading:"H1 "+b+" H6",link:"Link",image:"Image",ol:"Ordered List",ul:"Unordered List",rule:"Horizontal Rule",undo:"Undo",redo:"Redo"},prompts:{link_title:"link title goes here"+k,link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_url:"http://",image_url_title:"Image URL"},placeholders:{text:"text goes here"+k,heading_text:"Heading",link_text:"link text",list_ul_text:"List Item",list_ol_text:"List Item",image_alt:"Image"},keydown:function(){},click:function(){},ready:function(){},copy:function(){},cut:function(){},paste:function(){}},Q=V.body,j=V.createElement("div"),J=V.createElement("div"),X=V.createElement("div"),Z=null,et=0,tt=function(){},nt=e,lt=G.indent,rt=G.insert,it=G.outdent,at=G.replace,ot=G.select,ct=G.selection,st=G.updateHistory,ut=G.wrap,ft=o(W,t),pt=V.createElement("span"),dt=d(ft.UL).replace(/\\[-+*]/g,"[-+*]"),gt=d(ft.OL).replace(/%d/g,"[0-9]+"),ht=d(ft.tabSize),mt=d(ft.PRE);Y.event=function(e,t,n){return a(t,e,n)},Y.modal=function(e,t,n){r(e)&&(n=t,t=e,e="default"),e=e||"default",n=n||{},et=Q.scrollTop||V.documentElement.scrollTop,j.className=ft.modalOverlayClass.replace(/%s/g,e),J.className=ft.modalClass.replace(/%s/g,e),J.innerHTML='<div class="'+ft.modalHeaderClass.replace(/%s/g,e)+'"></div><div class="'+ft.modalContentClass.replace(/%s/g,e)+'"></div><div class="'+ft.modalFooterClass.replace(/%s/g,e)+'"></div>';var l=J.style;l.visibility="hidden",Q.appendChild(j),Q.appendChild(J),F.setTimeout(function(){var e=J.offsetWidth,t=J.offsetHeight;l.position="absolute",l.top="top"in n?n.top+"px":"50%",l.left="left"in n?n.left+"px":"50%",l.zIndex="9999",l.marginTop=("top"in n?"":et-t/2)+"px",l.marginLeft=("left"in n?"":0-e/2)+"px",l.visibility="",J.offsetTop<0&&!1 in n&&(l.top=0,l.marginTop=""),J.offsetLeft<0&&!1 in n&&(l.left=0,l.marginLeft="")},10),r(t)&&t(j,J)},Y.drop=function(e,t,n){r(e)&&(n=t,t=e,e="default"),!n&&Z&&(n={top:Z.offsetTop+Z.offsetHeight,left:Z.offsetLeft}),e=e||"default",n=n||{},et=Q.scrollTop||V.documentElement.scrollTop,X.className=ft.dropClass.replace(/%s/g,e);var l=X.style;l.visibility="hidden",Q.appendChild(X),F.setTimeout(function(){var e=X.offsetWidth,t=X.offsetHeight,r=Q.offsetWidth,i=Q.offsetHeight;l.position="absolute",l.top="top"in n?n.top+"px":"50%",l.left="left"in n?n.left+"px":"50%",l.zIndex="9999",l.marginTop=("top"in n?"":et-t/2)+"px",l.marginLeft=("left"in n?"":0-e/2)+"px",l.visibility="",n.top+t>i&&(l.top=i-t+"px",l.marginTop=""),n.left+e>r&&(l.left=r-e+"px",l.marginLeft="")},10),r(t)&&t(X)},Y.prompt=function(e,t,n,l,i){Y.modal("prompt",function(i,o){var c=function(e){r(l)?(Y.close(),l(e)):Y.close(!0)},s=V.createElement("input");s.type="text",s.value=t,a(s,"keydown",function(e){if(n){if(13==e.keyCode&&""!==this.value&&this.value!==t)return c(this.value),!1}else if(13==e.keyCode)return c(this.value==t?"":this.value),!1});var u=V.createElement("button");u.innerHTML=ft.buttons.ok,a(u,"click",function(){return n?""!==s.value&&s.value!==t&&c(s.value):c(s.value==t?"":s.value),!1});var f=V.createElement("button");f.innerHTML=ft.buttons.cancel,a(f,"click",function(){return Y.close(!0),!1}),o.children[0].innerHTML=e?e:"",o.children[1].appendChild(s),o.children[2].appendChild(u),o.children[2].appendChild(V.createTextNode(" ")),o.children[2].appendChild(f),F.setTimeout(function(){s.select()},10)},i)},Y.alert=function(e,t,n,l){Y.modal("alert",function(l,i){var o=V.createElement("button");o.innerHTML=ft.buttons.ok,a(o,"click",function(){return r(n)?(Y.close(),n()):Y.close(!0),!1}),i.children[0].innerHTML=e?e:"",i.children[1].innerHTML=t?t:"",i.children[2].appendChild(o)},l)},Y.confirm=function(e,t,l,i){Y.modal("confirm",function(i,o){var c=V.createElement("button");c.innerHTML=ft.buttons.ok,a(c,"click",function(){return n(l)&&r(l.OK)?(Y.close(),l.OK()):Y.close(!0),!1});var s=V.createElement("button");s.innerHTML=ft.buttons.cancel,a(s,"click",function(){return n(l)&&r(l.CANCEL)?(Y.close(),l.CANCEL()):Y.close(!0),!1}),o.children[0].innerHTML=e?e:"",o.children[1].innerHTML=t?t:"",o.children[2].appendChild(c),o.children[2].appendChild(V.createTextNode(" ")),o.children[2].appendChild(s)},i)},Y.close=function(e){if(g(j)&&Q.removeChild(j),g(J)&&Q.removeChild(J),g(X)&&Q.removeChild(X),e&&e!==!1){var t=ct();i(e)||(e={}),ot("start"in e?e.start:t.start,"end"in e?e.end:t.end)}},Y.scroll=function(e,t){l(e)?nt.scrollTop=e:nt.scrollTop+=parseInt(c(nt,"line-height"),10),r(t)&&t()},Y.time=function(e){var t=new Date,l=t.getFullYear(),r=t.getMonth()+1,i=t.getDate(),a=t.getHours(),o=t.getMinutes(),c=t.getSeconds(),s=t.getMilliseconds();10>r&&(r="0"+r),10>i&&(i="0"+i),10>a&&(a="0"+a),10>o&&(o="0"+o),10>c&&(c="0"+c),10>s&&(s="0"+s);var u={Y:""+l,m:""+r,d:""+i,H:""+a,i:""+o,s:""+c,u:""+s};return n(e)?u[e]:u},ft.toolbar&&(pt.className=ft.toolbarClass,nt.parentNode.insertBefore(pt,"before"==ft.toolbarPosition?nt:null));var vt=V.createElement("a");vt.href="#esc:"+(new Date).getTime(),vt.style.width=0,vt.style.height=0,nt.parentNode.appendChild(vt),a(j,"click",function(){Y.close(!0)}),Y.button=function(e,t){if("|"===e)return Y.separator(t);if(t=t||{},t.title!==!1){var n=V.createElement("a");if(n.className=ft.toolbarButtonClass.replace(/%s/g,e),n.setAttribute("tabindex",-1),n.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),n.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+ft.toolbarIconClass.replace(/%s/g,e)+'"></i>',t.title&&(n.title=t.title),i(t.attr))for(var l in t.attr){var o="class"==l?"className":l;"+="==t.attr[l].slice(0,2)?n[o]+=t.attr[l].slice(2):n[o]=t.attr[l]}if(a(n,"click",function(e){return r(t.click)?(Z=n,t.click(e,Y),ft.click(e,Y,this.hash.replace("#","")),!1):void 0}),t.position){var c=t.position<0?t.position+pt.children.length+1:t.position-1;pt.insertBefore(n,pt.children[c])}else pt.appendChild(n);W.buttons[e]=t}},Y.separator=function(e){e=e||{};var t=V.createElement("span");if(t.className=ft.toolbarSeparatorClass,i(e.attr))for(var n in e.attr){var l="class"==n?"className":n;"+="==e.attr[n].slice(0,2)?t[l]+=e.attr[n].slice(2):t[l]=e.attr[n]}if(e.position){var r=e.position<0?e.position+pt.children.length+1:e.position-1;pt.insertBefore(t,pt.children[r])}else pt.appendChild(t)},G.toggle=function(e,t,n,l){var i=ct();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)ut(e,t,0===i.value.length&&l?function(){at(/^.*$/,l===!0?ft.placeholders.text:l)}:1);else{var a=i.before.slice(-e.length)==e?i.before.slice(0,-e.length):i.before,o=i.after.slice(0,t.length)==t?i.after.slice(t.length):i.after;nt.value=a+i.value+o,ot(a.length,a.length+i.value.length,st)}r(n)&&n()};var xt=G.toggle,bt=0,Ct=ft.buttons;if(i(Ct)){var kt={bold:{title:Ct.bold,click:function(){var e=ft.STRONG;xt(e,e,1,!0)}},italic:{title:Ct.italic,click:function(){var e=ft.EM;xt(e,e,1,!0)}},code:{title:Ct.code,click:function(){var e=ct().value,t=ft.CODE,n=ft.PRE;if(-1!==e.indexOf("\n")&&e.length>0)if(-1===n.indexOf("%s")){var l="("+mt+"|\\t| {4})";G[e.match(RegExp("^"+l))?"outdent":"indent"](n)}else{var r=n.split("%s");xt(r[0],r[1]||r[0])}else xt(t,t,1,!0)}},"quote-right":{title:Ct.quote,click:function(){var e,t=ct(),n=p(t.before),l=u(t.value),r=f(t.after),i=n.length>0?"\n\n":"",a=l;0===l.length&&(l=ft.placeholders.text),a==ft.placeholders.text?ot(t.start,t.end):a.length>0?G[">"==a[0]?"outdent":"indent"]("> "):(nt.value=n+i+"> "+l+"\n\n"+r,e=n.length+i.length+2,ot(e,e+l.length,st))}},header:{title:Ct.heading,click:function(){var e,t=ct(),n=["","=","-","### ","#### ","##### ","###### "],l=p(t.before.replace(/#+ $/,"")),r=u(t.value.replace(/#+ |\n+[-=]+/,"").replace(/\n+/g," ")),i=f(t.after.replace(/^\n+[-=]+/,"")),a=l.length>0?"\n\n":"";if(bt=bt<n.length-1?bt+1:0,t.value.length>0)bt>0&&3>bt?(nt.value=l+a+r+"\n"+r.replace(/./g,n[bt])+"\n\n"+i,e=l.length+a.length,ot(e,e+r.length,st)):(nt.value=l+a+n[bt]+r+"\n\n"+i,e=l.length+a.length+n[bt].length,ot(e,e+r.length,st));else{var o=ft.placeholders.heading_text;bt=1,nt.value=l+a+o+"\n"+o.replace(/./g,n[bt])+"\n\n"+i,e=l.length+a.length,ot(e,e+o.length,st)}}},link:{title:Ct.link,click:function(){var e,t,n=ct(),l=ft.placeholders.link_text;Y.prompt(ft.prompts.link_url_title,ft.prompts.link_url,!0,function(r){t=r,Y.prompt(ft.prompts.link_title_title,ft.prompts.link_title,!1,function(r){e=r,ut("[","]("+t+(""!==e?' "'+e+'"':"")+")",0===n.value.length?function(){at(/^/,l)}:1)})})}},image:{title:Ct.image,click:function(){Y.prompt(ft.prompts.image_url_title,ft.prompts.image_url,!0,function(e){var t=ct(),n=p(t.before),l=f(t.after),r=n.length>0?"\n\n":"",i=decodeURIComponent(e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")).replace(/[-+._]+/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()});i=-1===i.indexOf("/")&&-1!==e.indexOf(".")?i:ft.placeholders.image_alt,nt.value=n+r+"!["+i+"]("+e+")\n\n"+l,ot(n.length+r.length+2+i.length+2+e.length+3,st)})}},"list-ol":{title:Ct.ol,click:function(){var e=ct(),t=0;if(e.value==ft.placeholders.list_ol_text)ot(e.start,e.end);else if(e.value.length>0)lt("",function(){at(/^[^\n]/gm,function(e){return t++,e.replace(/^/," "+ft.OL.replace(/%d/g,t))})});else{var n=" "+ft.OL.replace(/%d/g,1),l=n+ft.placeholders.list_ol_text;rt(l,function(){ot(e.start+n.length,e.start+l.length,st)})}}},"list-ul":{title:Ct.ul,click:function(){var e=ct();if(e.value==ft.placeholders.list_ul_text)ot(e.start,e.end);else{var t=" "+ft.UL;if(e.value.length>0)lt(t);else{var n=t+ft.placeholders.list_ul_text;rt(n,function(){ot(e.start+t.length,e.start+n.length,st)})}}}},"ellipsis-h":{title:Ct.rule,click:function(){var e=ct(),t=p(e.before),n=f(e.after),l=t.length>0?"\n\n":"";nt.value=t+l+ft.HR+"\n\n"+n,ot(t.length+l.length+ft.HR.length+2,st)}},undo:{title:Ct.undo,click:G.undo},repeat:{title:Ct.redo,click:G.redo}};for(var Et in kt)Y.button(Et,kt[Et])}a(nt,"focus",Y.close),a(nt,"copy",function(){var e=ct();F.setTimeout(function(){ft.copy(e)},1)}),a(nt,"cut",function(){var e=ct();F.setTimeout(function(){e.end=e.start,ft.cut(e),st()},1)}),a(nt,"paste",function(){var e=ct();F.setTimeout(function(){e.end=ct().end,e.value=nt.value.substring(e.start,e.end),ft.paste(e),st()},1)}),a(nt,"keydown",function(e){var t=ct(),n=t.before,l=t.value,r=t.after,i=t.start,a=t.end,o=e.keyCode,c=e.ctrlKey,u=e.shiftKey,f=e.altKey,g=9==o;F.setTimeout(function(){ft.keydown(e,Y)},1);var V=n,W=r[0],Q="\\"==V.slice(-1);if(-1!==V.indexOf("(")&&u&&48==o&&")"==W&&!Q||-1!==V.indexOf("{")&&u&&221==o&&"}"==W&&!Q||-1!==V.indexOf("[")&&221==o&&"]"==W&&!Q||-1!==V.indexOf('"')&&u&&222==o&&'"'==W&&!Q||-1!==V.indexOf("'")&&!u&&222==o&&"'"==W&&!Q||-1!==V.indexOf("`")&&!u&&192==o&&"`"==W&&!Q||-1!==V.indexOf("<")&&u&&190==o&&">"==W&&!Q)return ot(a+1),!1;if(u&&57==o&&!Q)return s("("+l+")",t);if(u&&219==o&&!Q)return s("{"+l+"}",t);if(!u&&219==o&&!Q)return s("["+l+"]",t);if(u&&222==o&&!Q)return s('"'+l+'"',t);if(!u&&222==o&&!Q)return s("'"+l+"'",t);if(!u&&192==o&&!Q)return s("`"+l+"`",t);if(u&&188==o&&!Q)return s("<"+l+">",t);if(u&&g)return it("( *"+gt+"| *"+dt+"|> *|"+ht+")",1,!0),!1;if(g){if(n.match(/<[^\/>]*?$/)&&">"==r[0]){var j=/<([^\/>]*?)$/.exec(n);return nt.value=n+" "+l+"></"+j[1].split(" ")[0]+r,ot(i+1,st),!1}return lt(ft.tabSize),!1}if(c&&90==o)return G.undo(),!1;if(c&&89==o||c&&82==o)return G.redo(),!1;if(ft.shortcut){if(c&&66==o)return kt.bold.click(),!1;if(c&&73==o)return kt.italic.click(),!1;if(c&&81==o)return kt["quote-right"].click(),!1;if(c&&72==o)return kt.header.click(),!1;if(c&&76==o)return kt.link.click(),!1;if(c&&71==o)return kt.image.click(),!1}if(32==o){var j="(^|\\n)("+p(gt)+"|"+p(dt)+")";if(n.match(RegExp(j+"$")))return nt.value=n.replace(RegExp(j+"$"),"$1 $2 ")+l+r,ot(a+2,st),!1}if(13==o){if(f&&0===l.length)return rt(q),!1;var J=RegExp("(?:^|\\n)( *)("+gt+"|"+dt+"|> )( *)(.*?)$");if(n.match(J)){var X=J.exec(n),Z=RegExp(gt).test(X[2])?ft.OL.replace(/%d/g,parseInt(X[2],10)+1):X[2];return rt("\n"+X[1]+Z+X[3],1),Y.scroll(),!1}var et=RegExp("(?:^|\\n)(("+ht+")+)(.*?)$").exec(n),ut=et?et[1]:"";return n.match(/[\(\{\[]$/)&&r.match(/^[\]\}\)]/)||n.match(/<[^\/]*?>$/)&&r.match(/^<\//)?(rt("\n"+ut+ht+"\n"+ut,function(){ot(i+ut.length+ft.tabSize.length+1,st)}),Y.scroll(),!1):(rt("\n"+ut),Y.scroll(),!1)}var pt={"'":m,'"':x,"---":C,"--":b,"...":k,"|":E,"(c)":T,"(C)":T,"(p)":y,"(P)":y,"(sm)":L,"(SM)":L," sm":L," SM":L,"(tm)":_,"(TM)":_," tm":_," TM":_,"(r)":O,"(R)":O,"+-":$,"-+":$,x:R,"/":H,"^":M,"<<":w,">>":N,"<":S,">":I,"<=":B,">=":U,"!=":P};if(l.length>0){if(f){at(/'([^']*?)'/g,h+"$1"+m,tt),at(/"([^"]*?)"/g,v+"$1"+x,tt);for(var mt in pt)at(RegExp(d(mt),"g"),pt[mt],tt);return st(),!1}}else{if(f){if(-1!==n.indexOf('"')&&'"'==r[0])return nt.value=n.replace(/"([^"]*?)$/,v+"$1")+x+r.slice(1),ot(a,st),!1;if(-1!==n.indexOf("'")&&"'"==r[0])return nt.value=n.replace(/'([^']*?)$/,h+"$1")+m+r.slice(1),ot(a,st),!1;if(n.slice(-2).match(/\w'$/i))return nt.value=n.slice(0,-1)+m+r,ot(a,st),!1;if(n.match(/\((c|p|sm|tm|r)$/i)&&")"==r[0]){var bt=n.match(/\((sm|tm)$/i)?2:1;return nt.value=n.slice(0,-(bt+1))+pt["("+n.slice(-bt).toLowerCase()+")"]+r.slice(1),ot(a-bt,st),!1}var Ct=n.replace(/&lt;/g,"<").replace(/&gt;/g,">"),Et=r.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(-1!==Ct.indexOf("<<")&&0===Et.indexOf(">>"))return nt.value=n.replace(/(?:<<|&lt;&lt;)([^<]*)$/,w+"$1")+r.replace(/^(?:>>|&gt;&gt;)/,N),ot(Ct.length-1,st),!1;if(-1!==Ct.indexOf("<")&&0===Et.indexOf(">"))return nt.value=n.replace(/(?:<|&lt;)([^<]*)$/,S+"$1")+r.replace(/^(?:>|&gt;)/,I),ot(Ct.length,st),!1;for(var mt in pt)if(n.slice(-mt.length)==mt)return nt.value=n.slice(0,-mt.length)+pt[mt]+r,ot(i-mt.length+1,st),!1;if(37==o)return rt(z),!1;if(38==o)return rt(K),!1;if(39==o)return rt(A),!1;if(40==o)return rt(D),!1}if(8==o){var j=" *("+gt+"|"+dt+"|> )";if(n.match(RegExp(j+"$")))return it(j,1,!0),!1;if(n.match(RegExp(ht+"$")))return it(ft.tabSize),!1;if(n.match(/<\/?[^>]*?>$/))return it("</?[^>]*?>",1,!0),!1;switch(n.slice(-1)){case"(":return xt("(",")"),!1;case"{":return xt("{","}"),!1;case"[":return xt("[","]"),!1;case'"':return xt('"','"'),!1;case"'":return xt("'","'"),!1;case"<":return xt("<",">"),!1;case"*":return xt("*","*"),!1;case"_":return xt("_","_"),!1;case"~":return xt("~","~"),!1;case"`":return xt("`","`"),!1;case v:return xt(v,x),!1;case h:return xt(h,m),!1;case w:return xt(w,N),!1;case S:return xt(S,I),!1}}}return 39==o&&r.match(/^<\/.*?>/)?(ot(a+r.indexOf(">")+1),!1):27==o?(vt.focus(),!1):void(f||c||u||F.setTimeout(st,1))}),ft.ready(Y),Y.grip=G,Y.grip.config=ft};